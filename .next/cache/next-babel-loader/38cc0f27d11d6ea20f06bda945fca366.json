{"ast":null,"code":"import { getLogs } from '../../../../../server/pm2';\nimport { database, session, method, authenticate, combine, RequestError } from '../../../../../server/middlewares';\nimport { UserAppRight } from '../../../../../shared/user';\n\nconst onRequest = async (req, res) => {\n  const {\n    query,\n    user\n  } = req;\n  const {\n    id,\n    instanceId\n  } = query;\n\n  if (!user.isAdmin && !user.hasRight(id, UserAppRight.VIEW)) {\n    throw new RequestError('You do not have access to this application.', 403);\n  }\n\n  const {\n    app,\n    output,\n    error\n  } = await getLogs(instanceId);\n\n  if (app.name != id) {\n    throw new RequestError('Application name and pm2 identifier mismatch.');\n  }\n\n  res.status(200).json({\n    output,\n    error\n  });\n};\n\nexport default combine(method('GET'), database, session, authenticate({\n  required: true\n}), onRequest);","map":null,"metadata":{},"sourceType":"module"}